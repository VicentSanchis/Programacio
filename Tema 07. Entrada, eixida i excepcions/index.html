
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../Tema%2006.%20Her%C3%A8ncia%2C%20polimorfisme%20i%20interf%C3%ADcies/" rel="prev"/>
<link href="../Tema%2008.%20Gr%C3%A0fics.%20ControlP5/" rel="next"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.1.15" name="generator"/>
<title>7.- Entrada, eixida, excepcions - PROGRAMACIÓ 1DAW</title>
<link href="../assets/stylesheets/main.26e3688c.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.ecc896b0.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../stylesheet/extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/mermaid/7.0.9/mermaid.neutral.css" rel="stylesheet"/>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#tema-8-entrada-eixida-i-excepcions">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="PROGRAMACIÓ 1DAW" class="md-header__button md-logo" data-md-component="logo" href=".." title="PROGRAMACIÓ 1DAW">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            PROGRAMACIÓ 1DAW
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              7.- Entrada, eixida, excepcions
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69Z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="white" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="PROGRAMACIÓ 1DAW" class="md-nav__button md-logo" data-md-component="logo" href=".." title="PROGRAMACIÓ 1DAW">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    PROGRAMACIÓ 1DAW
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Índex
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Tema%2001.%20Introducci%C3%B3%20a%20la%20programaci%C3%B3/">
        1.- Introducció programació
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Tema%2002.%20El%20llenguatge%20Java/">
        2.- El llenguatge Java
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Tema%2003.%20Programaci%C3%B3%20Modular/">
        3.- Programació Modular
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Tema%2004.%20Tipus%20compostos%20de%20dades/">
        4.- Tipus Compostos Dades
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Tema%2005.%20Programaci%C3%B3%20Orientada%20a%20Objectes/">
        5.- Prog Orientada Objectes
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Tema%2006.%20Her%C3%A8ncia%2C%20polimorfisme%20i%20interf%C3%ADcies/">
        6.- Herència, polimorfisme..
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          7.- Entrada, eixida, excepcions
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        7.- Entrada, eixida, excepcions
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduccio">
    Introducció
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#entrada-i-eixida-basiques">
    Entrada i eixida bàsiques
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#flux-de-dades-a-nivell-de-byte">
    Flux de dades a nivell de byte
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#flux-de-dades-a-nivell-de-caracter">
    Flux de dades a nivell de caracter
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#arxius-dobjectes">
    Arxius d'objectes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fitxers-xml">
    Fitxers XML
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#excepcions">
    Excepcions
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Tema%2008.%20Gr%C3%A0fics.%20ControlP5/">
        8.- Gràfics. ControlP5
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Tema%2009.%20Acc%C3%A9s%20a%20dades/">
        9.- Accés a dades
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="tema-8-entrada-eixida-i-excepcions">Tema 8. Entrada, eixida i excepcions</h1>
<h2 id="introduccio">Introducció</h2>
<p>Una part important de tot llenguatge de programació és com s’establirà el contacte amb l’exterior, bé siga mitjançant la <strong>consola</strong> o a través del <strong>sistema de fitxers</strong>, per finalment poder actuar amb l’usuari d’una aplicació en execució. Ambdós, consola i sistema de fitxers, poden funcionar tant d’entrada als nostres programes com d’eixida.</p>
<p>Java defineix una abstracció, els <strong>streams o fluxos</strong> per tractar la comunicació d’informació amb l’exterior. Per entendre-ho millor, un stream o flux és com un canal de comunicació entre un origen i un destí. Per exemple suposem el cas d’un programa que quan arranque haja de llegir una llista de clients d’un fitxer de text per crear una agenda. En aquest cas <strong>l’origen</strong> seria el fitxer de text i el <strong>destí</strong> el programa o aplicació que s’encarrega d’emplenar l’agenda amb el llistat de clients, doncs bé, l’stream en aquest escenari seria el <strong>canal de comunicació</strong> que s’establiria entre el fitxer de text i el programa per tal que aquest puga llegir la informació.</p>
<p><img alt="Streams" src="../assets/Tema8/EntradaEixida.png"/></p>
<p>A la imatge anterior es poden observar dos tipus de fluxos de dades: El primer és un flux d'entrada de dades, s'enten d'entrada perquè va del sistema de fitxers al programa, mentre que el segon representa un flux de dades d'eixida, ja que aquest va del programa al sistema de fitxers.</p>
<p>En aquest tema explicarem com Java tracta mitjançant objectes l’establiment d'aquests canals de comunicació i quines són les operacions que hi podem fer i com s’han d’utilitzar aquestes abstraccions de Java.
D’altra banda Java també ofereix el mecanisme d’excepcions per controlar els errors sobrevinguts. Una excepció és un problema que es produeix en temps d’execució. Java permet controlar aquests problemes i programar amb els try...catch la solució als errors en temps d’execució.</p>
<h2 id="entrada-i-eixida-basiques">Entrada i eixida bàsiques</h2>
<p>Com hem dit abans, Java organitza la entrada i eixida mitjançant l’ús d’streams, que són <strong>abstraccions en realitat</strong>, i aquests streams el que fan es transportar la informació del programa o aplicació a dispositius externs. Aquests dispositius externs poden ser bé fitxers o inclús la consola, que es tractada com un fitxer per Java.</p>
<h3 id="flux-i-jerarquia-de-classes">Flux i jerarquia de classes</h3>
<p>Com que les possibilitats que tenim en programació respecte de l’ús de fitxers és ampla, podem: llegir de fitxers, escriure en fitxers, llegir per una entrada com un teclat <strong>System.in</strong> o escriure en una eixida com un monitor <strong>System.out</strong>, Java en primera instància distingeix entre dos tipus de fluxos: <strong>flux de bytes</strong> i <strong>flux de caracters</strong></p>
<table>
<thead>
<tr>
<th>E/S</th>
<th>Bytes</th>
<th>Caracters</th>
</tr>
</thead>
<tbody>
<tr>
<td>Flux entrada</td>
<td>InputStream</td>
<td>Reader</td>
</tr>
<tr>
<td>Flux eixida</td>
<td>OutputStream</td>
<td>Writer</td>
</tr>
</tbody>
</table>
<p>Java declara quatre classes <strong>abstractes</strong>, és a dir, que no podem instanciar cap objectes d'aquestes classes, que deriven directament de la superclasse «Object» que són: <strong>InputStream</strong>, <strong>OutputStream</strong>, <strong>Reader</strong> i <strong>Writer</strong>.</p>
<p><strong>InputStream</strong> és la base per a totes les classes definides per al flux d’entrada de dades a nivell de bytes. A la imatge següent es mostren totes les classes que deriven d'InputStream.  De totes les classes derivades de la classe abstracta InputStream, veurem amb més detall les següents: FileInputStream, DataInputStream i ObjectInputStream.</p>
<p><img alt="Jerarquia Classes" src="../assets/Tema8/InputStreamClasses.png"/></p>
<p><strong>OutputStream</strong> és la classe base per a les classes que gestionen el flux d’eixida a nivell de bytes. A la imatge següent es poden observar totes les seues classes derivades. Pel que fa a aquesta classe abstracta, veurem amb més detall: FileOutputStream, DataOutputStream, PrintStream i ObjectOutputStream.</p>
<p><img alt="Jerarquia Classes" src="../assets/Tema8/OutputStreamClasses.png"/></p>
<p><strong>Reader</strong> és la classe per llegir streams a nivell de caracter. Observa les classes derivades a la imatge següent. D'aquesta classe abstracta veurem amb més detall: BufferedReader, InputStreamReader, FileReader</p>
<p><img alt="Jerarquia Classes" src="../assets/Tema8/ReaderClasses.png"/></p>
<p><strong>Writer</strong> és la classe per escriure a streams a nivell de caracter i les classes que deriven d'ell són les que es poden veure a la següent imatge. De totes les derivades ens centrarem en: OutputStreamWriter, FileWriter, BufferedWriter i PrintWriter.</p>
<p><img alt="Jerarquia Classes" src="../assets/Tema8/WriterClasses.png"/></p>
<div class="admonition danger">
<p class="admonition-title">Particularitats de Processing IDE</p>
<p>Processing IDE és un entorn de desenvolupament senzill que no té la potència d'altres entorns com <strong>Eclipse IDE</strong>, per tant moltes de les classes d'entrada i eixida que veurem en aquest tema no es podran provar en Processing. Sempre podem obrir un projecte nou en Eclipse o Visual Studio i provar els exemples que no funcionen en Processing IDE.</p>
</div>
<h3 id="consola">Consola</h3>
<p>Una de les possibilitats de realitzar l'entrada eixida a un programa és mitjançant la consola, on d'una banda es pot escriure i mostrar missatges i d'altra banda l'usuari pot introduir informació.</p>
<h4 id="utilitzant-bufferedreader">Utilitzant BufferedReader</h4>
<p><strong>BufferedReader</strong> és una classe derivada de la classe abstracta <strong>Reader</strong> que es troba dins del paquet <strong>java.io</strong>. A l'exemple següent es mostra com podem utilitzar aquesta classe.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Exemple per a Visual Studio Code o Eclipse IDE</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.BufferedReader</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.InputStreamReader</span><span class="p">;</span>

<span class="n">BufferedReader</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">InputStreamReader</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">));</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">String</span><span class="w"> </span><span class="n">strName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">();</span>
<span class="w">   </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Hola: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">strName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"!"</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span>
<span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"S'ha produit un error: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
<span class="p">}</span><span class="w"> </span>
<span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">reader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w"> </span><span class="c1">// És molt important tancar els streams</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Consideracions de l'exemple anterior:</p>
<ul>
<li>S'han d'importar les llibreries necessàries per poder utilitzar les classes necessàries.</li>
<li>Per instanciar un objecte de la classe BufferedReader, el constructor necessita que se li passe un objecte de tipus <strong>InputStreamReader</strong> que apunte al flux d'entrada predefinit <strong>System.in</strong> (el teclat)</li>
<li>Tota instrucció relacionada amb els streams, s'han de posar dins d'un bloc try..catch.</li>
</ul>
<h4 id="utilitzant-scanner">Utilitzant Scanner</h4>
<p>L'altra alternativa, més comoda al meu entendre, és l'ús de la classe <strong>Scanner</strong>. Aquesta classe es troba dins del paquet <strong>java.util</strong> i és una derivada de la classe arrel <strong>Object</strong>. Observa l'exemple següent d'ús de la classe <strong>Scanner</strong>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Exemple per a Visual Studio Code o Eclipse IDE</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Scanner</span><span class="p">;</span>

<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Per favor escriu el teu nom i prem Intro"</span><span class="p">);</span>
<span class="n">Scanner</span><span class="w"> </span><span class="n">scanner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>
<span class="n">String</span><span class="w"> </span><span class="n">strName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">();</span>

<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Hola: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">strName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"!"</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>Algunes consideracions:</p>
<ul>
<li>S'han d'importar les llibreries necessàries per poder utilitzar les classes necessàries.</li>
<li>Per instanciar un objecte de la classe Scanner, el constructor necessita que se li passe un flux d'entrada com pot ser: <strong>System.in</strong> (el teclat)</li>
<li>A diferència del BufferedReader no és necessari posar el codi dins del bloc try..catch</li>
</ul>
<h4 id="bufferedreader-a-processing-ide">BufferedReader a Processing IDE</h4>
<p>A l'API de Processing existeix  una classe <strong>BufferedReader.</strong> Aquesta classe s'encarrega de llegir línia a línia com un conjunt d'Strings individuals.  Però s'utilitza per a llegir de fitxers i no de l'entrada (system.in) com als exemples anteriors. Per poder llegir des de teclat a Processing hem d'utilitzar el mètode <strong>keyPressed</strong></p>
<p>Abans de copiar i provar el següent exemple, descarrega el fitxer <a href="../assets/Tema8/positions.txt"><strong>positions.txt</strong></a> amb parells de números a cada línia separats per un tabulador.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">BufferedReader</span><span class="w"> </span><span class="n">reader</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Open the file from the createWriter() example</span>
<span class="w">  </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createReader</span><span class="p">(</span><span class="s">"positions.txt"</span><span class="p">);</span><span class="w">    </span>
<span class="p">}</span>
<span class="w"> </span>
<span class="kt">void</span><span class="w"> </span><span class="nf">draw</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">    </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">line</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Stop reading because of an error or file is empty</span>
<span class="w">    </span><span class="n">noLoop</span><span class="p">();</span><span class="w">  </span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">pieces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="n">TAB</span><span class="p">);</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="n">pieces</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">);</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="n">pieces</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">);</span>
<span class="w">    </span><span class="n">point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<h3 id="flux-darxius">Flux d'arxius</h3>
<p>Un <strong>arxiu o fitxer</strong> és un conjunt de bytes que són emmagatzemats en un dispositiu. Un arxiu o fitxer es identificat per un nom i la descripció de la carpeta o directori (la ruta) que el conté. Una de les principals finalitats dels arxius és tindre desats en <strong>memòria secundària</strong>, quan les aplicacions ja han acabat d’executar-se, i que siguen recuperables després.</p>
<p>Un <strong>fitxer</strong> s’ha de poder llegir, actualitzar, esborrar registres i tornar a guardar-se de nou amb tots els canvis realitzats. Segons el dispositiu físic que els emmagatzeme, els arxius poden ser <strong>directes o seqüencials</strong>, el primer implica que per poder accedir a qualsevol registre, hem de passar prèviament pels anteriors, per exemple una cinta magnètica, mentre que el segon tipus d’arxiu permet l’accés directe al registre en qüestió sense haver de passar pels anteriors. </p>
<p>En Java un arxiu és una <strong>seqüencia de bytes</strong> que contenen la informació emmagatzemada. Per poder treballar amb aquestes seqüencies de bytes, Java disposa de classes com són els tipus bàsics (int, double, string..).
D’una altra banda, com ja hem explicat abans, un flux és una abstracció que es refereix a una corrent <strong>(stream)</strong> de dades entre un origen (també conegut com a font o productor) i una destinació o embornal (consumidor) i la connexió que existeix entre els dos també es coneix com a pipe o tub per on circules les dades.</p>
<p>Quan comença qualsevol execució d’un programa Java, es creen tres objectes flux, canals pels que pot fluir informació d’entrada o eixida; aquests objectes estan definits a la classe System i són:</p>
<ul>
<li><strong>System.in:</strong> entrada estàndard, permet l’entrada de dades des del teclat.Una excepció és un fallo que es produeix en temps d’execució. Classe <strong>InputStream</strong></li>
<li><strong>System.out:</strong> eixida estàndard, permet la programa imprimir per pantalla. Classe <strong>PrintStream</strong></li>
<li><strong>System.err:</strong> eixida d’errors, permet al programa imprimir errors per pantalla Per defecte sol ser la mateixa eixida que System.out. Classe <strong>PrintStream</strong></li>
</ul>
<h3 id="class-file">Class File</h3>
<p>Per poder identificar d’un fitxer al sistema de fitxers de qualsevol sistema operatiu, necessitem: nom i ruta. Per exemple ‘/user/data/file.txt’. El fitxer es diu file.txt i la ruta en la qual es troba és ‘/user/data/’. Aquest identificador de fitxer és el que es passa al constructor de la classe per tal d’obrir un flux.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.*</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">strPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="p">;</span>
<span class="n">File</span><span class="w"> </span><span class="n">fitxer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">strPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"prova.txt"</span><span class="p">);</span>
<span class="c1">// Fes el que vullgues fer amb el fitxer</span>
</code></pre></div></td></tr></table></div>
<p>En l’exemple anterior hem utilitzat la <strong>classe File</strong> per tal d’instanciar un stream al fitxer que li hem passat per paràmetre «prova.txt». Compte que s’ha de passar la ruta absoluta d’on es troba el fitxer utilitzant la funció de Processing IDE <strong>sketchPath()</strong>.</p>
<p>Hi ha alternatives al constructor de la classe File que hem mostrat a l’exemple anterior, es pot construir també amb dos paràmetres: ruta i nom del fitxer o inclús indicar-li la ruta mitjançant un altre objecte File.</p>
<p>Els mètodes de la classe File són:</p>
<table>
<thead>
<tr>
<th>Mètode</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>public boolean exists()</td>
<td>Torna true si el fitxer existeix</td>
</tr>
<tr>
<td>public boolean canWrite()</td>
<td>Torna true si es pot escriure al fitxer</td>
</tr>
<tr>
<td>public boolean canRead()</td>
<td>Torna true si es només de lectura</td>
</tr>
<tr>
<td>public boolean isFile()</td>
<td>Torna true si és un fitxer</td>
</tr>
<tr>
<td>public boolean isDirectory()</td>
<td>Torna true si és un directori</td>
</tr>
<tr>
<td>public boolean isAbsolute()</td>
<td>Torna true si el directori té ruta completa</td>
</tr>
<tr>
<td>public long length()</td>
<td>Torna la mida en bytes del fitxer</td>
</tr>
<tr>
<td>public long lastModified()</td>
<td>Torna el timestamp de l’última modificació</td>
</tr>
<tr>
<td>public String getName()</td>
<td>Torna una string amb el nom del fitxer</td>
</tr>
<tr>
<td>public String getPath()</td>
<td>Torna una string amb el path del fitxer</td>
</tr>
<tr>
<td>public String getAbsolutePath()</td>
<td>Torna la ruta absoluta del fitxer</td>
</tr>
<tr>
<td>public boolean setReadOnly()</td>
<td>Converteix el fitxer en només lectura</td>
</tr>
<tr>
<td>public boolean delete()</td>
<td>Elimina el fitxer o directori (si està buit)</td>
</tr>
<tr>
<td>public boolean renameTo(File nou)</td>
<td>Canvia el nom pel del fitxer nou</td>
</tr>
<tr>
<td>public boolean mkdir()</td>
<td>Crea el directori del fitxer</td>
</tr>
<tr>
<td>public String[] list()</td>
<td>Torna un array d’strings dels elements</td>
</tr>
</tbody>
</table>
<details class="question">
<summary>Activitat 801. Class File</summary>
<p>Crea un projecte en Processing IDE que obriga un fitxer de prova qualsevol, per exemple: prova.txt. 
  Revisa els mètodes de la classe File i comprova el funcionament d'alguns d'ells per exemple: getName();
  Mostra per pantalla una fitxa en la que es mostre la següent informació: </p>
<ul>
<li>Nom del fitxer</li>
<li>Ruta absoluta del fitxer</li>
<li>Data de l'última vegada que s'ha modificat</li>
</ul>
</details>
<!--      [Descarrega la solució ací](assets/Tema8/act801.zip) -->
<p>Com hauràs pogut comprovar amb <strong>la classe File</strong> t'ha resultat impossible escriure o llegir d'ell.  A continuació estudiarem amb més detall les diferents classes que disposa Java pel tractament de l'entrada i eixida d'informació (Streams). Per tal entendre-ho millor, dividirem aquesta secció en dos blocs: <strong>Tractament a nivell de byte</strong> amb les classes abstractes <strong>InputStream i OutputStream</strong> i les seues classes derivades i <strong>tractament a nivell de caracter</strong> amb les classes abstractes <strong>Writer i Reader</strong> i les seues subclasses.</p>
<h2 id="flux-de-dades-a-nivell-de-byte">Flux de dades a nivell de byte</h2>
<p>Com ja hem explicat abans, el tractament de l'entrada eixida en java a nivell de bytes es fa amb les classes abstractes <strong>InputStream i OutputStream</strong> de les quals deriven les classes: </p>
<ul>
<li>FileInputStream i FileOutputStream</li>
<li>PipedInputStream i PipedOutputStream </li>
<li>FilterInputStream i FilterOutputStream</li>
<li>ByteArrayInputStream i ByteArrayOutputStream</li>
<li>ObjectInputStream i ObjectOutputStream, etc.. </li>
</ul>
<h3 id="fileinputstream-i-fileoutputstream">FileInputStream i FileOutputStream</h3>
<p>Tot arxiu es pot considerar en sí mateix una seqüència de bytes de baix nivell i després sobre aquesta informació es pot construir informació de mes alt nivell per tal de processar dades més complexes des de tipus bàsic fins objectes. </p>
<p>En altres paraules, si volem obrir un flux de dades a un fitxer o arxiu i volem llegir byte a byte per després decidir nosaltres a nivell de programació que volem fer amb aquests bytes, hauríem d’utilitzar aquestes classes.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.*</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">strPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="p">;</span>
<span class="n">FileInputStream</span><span class="w"> </span><span class="n">fen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="n">strPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"provat.txt"</span><span class="p">);</span>
<span class="c1">// Fem el que hem de fer amb le fitxer i després s'ha de tancar</span>
<span class="n">fen</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<p>La classe <strong>FileInputStream</strong> s’utilitza per llegir bytes o grups de bytes del fitxer associat. Tots els mètodes tenen visibilitat pública i s’ha de tenir en compte quina és l’excepció que llencen per controlar els possibles errors en temps d’execució.</p>
<table>
<thead>
<tr>
<th>Mètode</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>FileOutputStream(String nombre) throws IOException;</td>
<td>Crea un objecte inicialitzat amb el nom d’arxiu que es passa com argument</td>
</tr>
<tr>
<td>FileOutputStream(String nombre, boolean sw) throws IOException;</td>
<td>Crea un objecte inicialitzat amb el nom d’arxiu que es passa per paràmetre. Si sw és true els nous bytes s’afegeixen al final</td>
</tr>
<tr>
<td>FileOutputStream(File nombre) throws IOException;</td>
<td>Crea un objecte inicialitzat amb l’objecte file que es passa per paràmetre</td>
</tr>
<tr>
<td>void write(byte a) throws IOException;</td>
<td>Escriu el byte ‘a’ al flux associat</td>
</tr>
<tr>
<td>void write(byte[] s) throws IOException;</td>
<td>Escriu l’array de bytes ‘s’ al flux</td>
</tr>
<tr>
<td>void write(byte[] s, int org, int len) throws IOException;</td>
<td>Llig una seqüència de bytes del flux i la desa a ‘s’ començant per ‘org’ i una mida de ‘len’. Torna -1 si arriba al final del fitxer</td>
</tr>
<tr>
<td>void close()throws IOException;</td>
<td>Tanca el flux i el fitxer queda lliure per al seu ús posterior</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Exemple 1</p>
<p>A continuació obrirem el fitxer «prova.txt» amb un FileInputStream per llegir-lo i desarem el seu contingut a un fitxer d’eixida «resultat.txt» que obrirem amb un FileOutputStream. Al fitxer d’eixida, bolcarem el contingut de «prova.txt»</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.*</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">String</span><span class="w"> </span><span class="n">strPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="p">;</span>
<span class="w">      </span><span class="n">FileInputStream</span><span class="w"> </span><span class="n">fen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="n">strPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"prova.txt"</span><span class="p">);</span>
<span class="w">      </span><span class="n">FileOutputStream</span><span class="w"> </span><span class="n">fout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="n">strPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"resultat.txt"</span><span class="p">);</span>

<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">byteLlegit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fen</span><span class="p">.</span><span class="na">read</span><span class="p">();</span>
<span class="w">      </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">byteLlegit</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="n">fout</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">byteLlegit</span><span class="p">);</span>
<span class="w">         </span><span class="n">byteLlegit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fen</span><span class="p">.</span><span class="na">read</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="n">fen</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="w">      </span><span class="n">fout</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">FileNotFoundException</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">println</span><span class="p">(</span><span class="s">"Fitxer no trobat"</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">println</span><span class="p">(</span><span class="s">"Error d'entrada eixida"</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
<details class="question">
<summary>Activitat 802. Copiar i invertir</summary>
<p>Basat en el codi anterior i fes que al fitxer resultat, el d’eixida, es copie el que apareix a «prova.txt», el d’entrada però a l’inrevés. Per exemple:</p>
<p>Un possible resultat de l'activitat anterior podria ser el que es pot observar a la imatge següent:      </p>
<p><img alt="Fitxers Invertits" src="../assets/Tema8/FitxersInvertits.png"/></p>
</details>
<!--      [Descarrega la solució ací](assets/Tema8/act802.zip)-->
<h3 id="datainputstream-i-dataoutputstream">DataInputStream i DataOutputStream</h3>
<p>La veritat és que treballar amb bytes quan estem parlant de fitxers o arxius que contenen informació o dades de més nivell pot resultar incomode, ja que entre altres hauríem de saber quants bytes té un caràcter, un enter o un doble. </p>
<p>En Java tenim les classes <strong>DataInputStream</strong> i <strong>DataOutputStream</strong> que són subclasses de les classes <strong>FilterInputStream</strong> i <strong>FilterOutputStream</strong>. </p>
<p>Abans d'entrar en el detall d'aquestes classes, veurem amb més profunditat que són les classes FilterInputStream i FilterOutputStream. Aquestes dues classes deriven de les classes abstractes InputStream i OutputStream. Bàsicament el que fan es sobreescriure tots els mètodes de les seues super classes i permeten agrupar bytes (Input) i desagrupar-lo(Output) de tal forma que classes derivades seues podran treballar amb informació de més alt nivell.</p>
<p>Per tal d'instanciar un objecte de la classe <strong>DataInputStream</strong> d'on es podria llegir, ho fariem de la següent manera:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">String</span><span class="w"> </span><span class="n">strPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="p">;</span>
<span class="n">FileInputStream</span><span class="w"> </span><span class="n">gs</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="n">strPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"prova.txt"</span><span class="p">);</span>
<span class="n">DataInputStream</span><span class="w"> </span><span class="n">ent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataInputStream</span><span class="p">(</span><span class="n">gs</span><span class="p">);</span>
<span class="c1">// Treballem amb ells i com passava amb els streams anteriors també els hem de tancar</span>
<span class="n">gs</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="n">ent</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<p><strong>Observa el codi anterior:</strong> Primer s'instancia un objecte de la classe <strong>FileInputStream</strong> (derivada de InputStream) en la que se li indica la ruta del fitxer amb el que volem treballar. Després aquest objecte FileInputStream s'utilitza per poder instanciar un objecte de la classe <strong>DataInputStream</strong> que utilitzarem per llegir tipus de dades primitius del fitxer.</p>
<p>Bàsicament aquestes classes el que fan és organitzar els bytes en tipus primitius de tal forma que ja podem treballar llegint i escrivint als fluxos: enters, caràcters, reals, cadenes etc..</p>
<table>
<thead>
<tr>
<th>Mètode</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>public DataInputStream(InputStream entrada) throws IOException</td>
<td>Crea un objecte associat a l’stream que es passa per paràmetre</td>
</tr>
<tr>
<td>public final boolean readBoolean() throws IOException</td>
<td>Torna el valor de tipus booleà llegit</td>
</tr>
<tr>
<td>public final byte readByte() throws IOException</td>
<td>Torna el valor de tipus byte llegit</td>
</tr>
<tr>
<td>public final short readShort() throws IOException</td>
<td>Torna el valor de tipus short llegit</td>
</tr>
<tr>
<td>public final char readChar() throws IOException</td>
<td>Torna el valor de tipus char llegit</td>
</tr>
<tr>
<td>public final int readInt() throws IOException</td>
<td>Torna el valor de tipus int llegit</td>
</tr>
<tr>
<td>public final long readLong() throws IOException</td>
<td>Torna el valor de tipus long llegit</td>
</tr>
<tr>
<td>public final float readFloat() throws IOException</td>
<td>Torna el valor de tipus float llegit</td>
</tr>
<tr>
<td>public final double readDouble() throws IOException</td>
<td>Torna el valor de tipus double llegit</td>
</tr>
<tr>
<td>public final String readUTF() throws IOException</td>
<td>Torna una cadena que es va escriure en UTF</td>
</tr>
</tbody>
</table>
<p>D’aquesta forma ja no ens hem de preocupar de saber quants bytes de memòria s’han de reservar per un caràcter o un enter. Per exemple si associem  un <strong>DataOutputStream</strong> a un fitxer i després cridem al mètode <strong>writeInt</strong>, realment el que s’està fent és escriure 4 bytes d’informació al fitxer de la qual cosa s’estaria encarregant de manera transparent a l’usuari.</p>
<p>Per tal d'instanciar un objecte de la classe <strong>DataOutputStream</strong>, on es podria escriure, ho fariem de la següent forma:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">String</span><span class="w"> </span><span class="n">strPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="p">;</span>
<span class="n">FileOutputStream</span><span class="w"> </span><span class="n">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="n">strPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"result.txt"</span><span class="p">);</span>
<span class="n">DataOutputStream</span><span class="w"> </span><span class="n">snb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataOutputStream</span><span class="p">(</span><span class="n">fn</span><span class="p">);</span>
<span class="c1">// Treballem amb ells i tanquem.</span>
<span class="n">fn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="n">snb</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<p>Al contrari que passava amb el DataInputStream, al codi anterior estem instanciant un objecte de la classe <strong>DataOutputStream</strong> que utilitzarem per escriure la informació desitjada.</p>
<table>
<thead>
<tr>
<th>Mètode</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>public DataOutputStream(OutputStream destino) throws IOException</td>
<td>Crea un objecte associat a l’outputstream que es passa per paràmetre</td>
</tr>
<tr>
<td>public final void writeBoolean(boolean v) throws IOException</td>
<td>Escriu un boolean</td>
</tr>
<tr>
<td>public final void writeByte(int v) throws IOException</td>
<td>Escriu un byte</td>
</tr>
<tr>
<td>public final void writeShort(int v) throws IOException</td>
<td>Escriu un short</td>
</tr>
<tr>
<td>public final void writeChar(int v) throws IOException</td>
<td>Escriu un char</td>
</tr>
<tr>
<td>public final void writeChars(String v) throws IOException</td>
<td>Escriu tots els chars que conté la String v</td>
</tr>
<tr>
<td>public final void writeInt(int v) throws IOException</td>
<td>Escriu un int</td>
</tr>
<tr>
<td>public final void writeLong(long v) throws IOException</td>
<td>Escriu un long</td>
</tr>
<tr>
<td>public final void writeFloat(float v) throws IOException</td>
<td>Escriu un float</td>
</tr>
<tr>
<td>public final void writeDouble(double v) throws IOException</td>
<td>Escriu un double</td>
</tr>
<tr>
<td>public final void writeUTF(String cad) throws IOException</td>
<td>Escriu la cadena cad en format UTF</td>
</tr>
<tr>
<td>public final int close()throws IOException</td>
<td>Tanca el flux</td>
</tr>
</tbody>
</table>
<p>Un altre exemple d'ús del <strong>DataInputStream:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.*</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">strPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"prova.txt"</span><span class="p">;</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">InputStream</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="n">strPath</span><span class="p">);</span>
<span class="w">    </span><span class="n">DataInputStream</span><span class="w"> </span><span class="n">inst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataInputStream</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="na">available</span><span class="p">();</span><span class="w">  </span><span class="c1">// Quants bytes té l'arxiu</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">count</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="n">inst</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">arr</span><span class="p">);</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="w"> </span><span class="n">byt</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">arr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">byt</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">          </span><span class="c1">// Si no es tracta del caracter EOF (10 ASCII)</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="n">ki</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="w"> </span><span class="n">byt</span><span class="p">;</span>
<span class="w">        </span><span class="n">print</span><span class="p">(</span><span class="n">ki</span><span class="o">+</span><span class="s">"-"</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="s">"Algo val mal"</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>A continuació podem veure un exemple en el que fem ús del <strong>DataOutputStream i DataInputStream</strong>. El que fa aquest exemple és escriure a un fitxer d’eixida «pluges.dat» dos valors double aleatoris per després llegir-los amb un DataInputStream i mostrar-los per pantalla. </p>
<p>El codi podria ser el següent:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">String</span><span class="w"> </span><span class="n">strPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="p">;</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">FileOutputStream</span><span class="w"> </span><span class="n">fos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="n">strPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"pluges.dat"</span><span class="p">);</span>
<span class="w">    </span><span class="n">DataOutputStream</span><span class="w"> </span><span class="n">dos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataOutputStream</span><span class="p">(</span><span class="n">fos</span><span class="p">);</span>

<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">info</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">    </span><span class="n">dos</span><span class="p">.</span><span class="na">writeDouble</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<span class="w">    </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">    </span><span class="n">dos</span><span class="p">.</span><span class="na">writeDouble</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>

<span class="w">    </span><span class="n">FileInputStream</span><span class="w"> </span><span class="n">fis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="n">strPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"pluges.dat"</span><span class="p">);</span>
<span class="w">    </span><span class="n">DataInputStream</span><span class="w"> </span><span class="n">dis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataInputStream</span><span class="p">(</span><span class="n">fis</span><span class="p">);</span>

<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">info2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readDouble</span><span class="p">();</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Primer valor: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">info2</span><span class="p">);</span>
<span class="w">    </span><span class="n">info2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readDouble</span><span class="p">();</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Segon valor: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">info2</span><span class="p">);</span>

<span class="w">    </span><span class="n">fos</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="w">    </span><span class="n">dos</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="w">    </span><span class="n">fis</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="w">    </span><span class="n">dis</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">FileNotFoundException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"El fitxer no existeix"</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Error IO inesperat"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<details class="question">
<summary>Activitat 803. Data Input i Data Output</summary>
<p>Crea un projecte en Processing copia el codi anterior i una vegada acabada l'execució del programa, obre el fitxer "pluges.dat" i compara el que s'ha mostrat a consola amb el que s'ha gravat al fitxer. Posa el mateix? Per què?</p>
</details>
<!--[Descarrega la solució ací](assets/Tema8/act803.zip)-->
<h3 id="printstream">PrintStream</h3>
<p>La classe <strong>PrintStream</strong> deriva de <strong>FilterOutputStream</strong> i el valor afegit d’aquesta classe derivada és que permet afegir el caràcter final de línia als fitxers. Aquests tipus de fluxos són sempre d’eixida i s’associen a un altre flux de bytes de més baix nivell. <strong>System.out</strong> és un objecte de tipus PrintStream. Per tant quan executem la sentència System.out.println(""); el que estem fent realment és cridar al mètode println de la classe PrintStream.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">String</span><span class="w"> </span><span class="n">strPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">strFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"Complex.dat"</span><span class="p">;</span>
<span class="n">PrintStream</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PrintStream</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="n">strFile</span><span class="p">));</span>
<span class="c1">// Treballem i tanquem</span>
<span class="n">ps</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<table>
<thead>
<tr>
<th>Mètode</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>public PrintStream(OutputStream destino)</td>
<td>Crea un objecte associat a qualsevol objecte d’eixida per paràmetre</td>
</tr>
<tr>
<td>public PrintStream(OutputStream destino, boolean flag)</td>
<td>Crea un objecte associat a qualsevol objecte d’eixida per paràmetre. Si flag és true, es produeix un bolcat automàtic al escriure final de línia.</td>
</tr>
<tr>
<td>public void flush()</td>
<td>Bolca el flux actual</td>
</tr>
<tr>
<td>public void print(Object obj)</td>
<td>Escriu la representació de l’objecte obj al flux</td>
</tr>
<tr>
<td>public void print(String cad)</td>
<td>Escriu la cadena al flux</td>
</tr>
<tr>
<td>public void print(char c)</td>
<td>Escriu un caràcter al flux</td>
</tr>
<tr>
<td>public void println(Object obj)</td>
<td>Escriu la representació de l’objecte al flux i final de línia</td>
</tr>
<tr>
<td>public void println(String cad)</td>
<td>Escriu la cadena al flux i final de línia</td>
</tr>
</tbody>
</table>
<p>Observa el codi següent. Utilitzant la classe <strong>PrintStream</strong> s'obre un fitxer 'output.txt' dintre del qual s'escriurà una sola cadena de caracters 'data' i després es tancarà l'stream una vegada finalitzat l'execució del codi.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.*</span><span class="p">;</span>

<span class="n">String</span><span class="w"> </span><span class="n">strFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"output.txt"</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Text que volem escriure dintre del fitxer"</span><span class="p">;</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">PrintStream</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PrintStream</span><span class="p">(</span><span class="n">strFile</span><span class="p">);</span>

<span class="w">   </span><span class="n">output</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
<span class="w">   </span><span class="n">output</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">e</span><span class="p">.</span><span class="na">getStackTrace</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<details class="question">
<summary>Activitat 804. LLig per teclat i copia</summary>
<p>Utilitzant el mètode mouseClicked fes una aplicació de tal forma que tot allò que es teclege es guarde en un fitxer de text juntament amb l'hora a la qual s'ha escrit. Per exemple, si l'usuari escriu per pantalla el seu nom, "Manolo" i prem Intro, al fitxer d'eixida s'hauria de gravar: </p>
<p>[09:05:25] - Manolo</p>
<p>Has d'utilitzar la classe <strong>PrintStream</strong> per fer aquesta activitat.</p>
</details>
<!--      [Descarrega la solució ací](assets/Tema8/act804.zip)-->
<h2 id="flux-de-dades-a-nivell-de-caracter">Flux de dades a nivell de caracter</h2>
<p>Una altra forma de poder treballar amb fitxers en lloc de a nivell de byte com estavem fent als apartats anteriors, és fer-ho a nivell de caracter. Al cap i a la fi els arxius, en una gran majoria, solen ser seqüències de caracters i des del punt de vista lògic ens resulta més natural treballar amb ells a aquest nivell.</p>
<h3 id="reader-i-writer">Reader i writer</h3>
<p>Els arxius de text són arxius de caràcters, es poden crear fluxos de bytes o de caràcters derivats de les classes abstractes Reader i Writer.</p>
<p>Els fluxos <strong>Reader i Writer</strong> són fluxos de Java orientats a caràcters. Amb aquests fluxos podem llegir i escriure caràcters o cadenes de caràcters al dispositius connectats mitjançant aquests fluxos.</p>
<p>Per llegir arxius de caràcters s’utilitzen fluxos derivats de la classe Reader on es declaren o sobreescriuen mètodes per la lectura de caràcters. Els mètodes més importants són:</p>
<table>
<thead>
<tr>
<th>Mètode</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>public int read()</td>
<td>Llig un caràcter en forma d’enter. Si arriba al final del fitxer torna -1</td>
</tr>
<tr>
<td>public int read(char [] b)</td>
<td>Llig una seqüencia de caràcters fins completar l’array b o llegir el final del fitxer. Torna el nombre de caràcters llegits o -1 si arriba al final de l’arxiu</td>
</tr>
</tbody>
</table>
<h3 id="inputstreamreader-i-outputstreamwriter">InputStreamReader i OutputStreamWriter</h3>
<p>Els fluxos de la classe <strong>InputStreamReader</strong> envolten (wrap) a un flux de bytes; converteixen la seqüència de bytes en seqüència de caràcters i així ja no ho hem de fer nosaltres; la classe deriva directament de Reader, pel que té disponibles els mètodes read() de la seua classe pare per la lectura de caràcters</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">InputStreamReader</span><span class="w"> </span><span class="n">ent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">InputStreamReader</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>
<span class="c1">// En acabar tanquem l'stream</span>
<span class="n">ent</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
La classe <strong>OutputStreamWriter</strong> que deriva de <strong>writer</strong>, permet escriure caràcters en un flux de bytes al qual s’associa la creació de l’objecte o flux.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">OutputStreamWriter</span><span class="w"> </span><span class="n">ot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OutputStreamWriter</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="n">arxiu</span><span class="p">));</span>
<span class="c1">// Després hem de recordar de tancar l'stream</span>
<span class="n">ot</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
Els mètodes de la classe <strong>InputStreamReader</strong> són:</p>
<table>
<thead>
<tr>
<th>Mètode</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>void close()</td>
<td>Tanca el flux i allibera tots els recursos del sistema associats</td>
</tr>
<tr>
<td>String getEncoding()</td>
<td>Retorna el nom de la codificació de caràcters que utilitza aquest flux</td>
</tr>
<tr>
<td>int read()</td>
<td>Llegeix un sol caràcter</td>
</tr>
<tr>
<td>int read(char[] buf, int offset, int length)</td>
<td>Llegeix caràcters en una part d'una matriu</td>
</tr>
<tr>
<td>boolean ready()</td>
<td>Indica si aquest flux està llest per ser llegit</td>
</tr>
</tbody>
</table>
<p>Els mètodes de la classe <strong>OutputStreamWriter</strong> són:</p>
<table>
<thead>
<tr>
<th>Mètode</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>void close()</td>
<td>Tanca el corrent, rentant-lo primer</td>
</tr>
<tr>
<td>void flush()</td>
<td>Redueix el corrent</td>
</tr>
<tr>
<td>String getEncoding()</td>
<td>Retorna el nom de la codificació de caràcters que utilitza aquest flux</td>
</tr>
<tr>
<td>void write(char [] buf, int off, int len)</td>
<td>Escriu una part d'una matriu de caràcters</td>
</tr>
<tr>
<td>void write(int c)</td>
<td>Escriu un sol caràcter</td>
</tr>
<tr>
<td>void write(String str, int off, int len)</td>
<td>Escriu una part d'una cadena</td>
</tr>
</tbody>
</table>
<details class="question">
<summary>Activitat 805. InputStreamReader i OutputStreamReader</summary>
<p>Repeteix l'activitat anterior, la 804, però utilitzant InputStreamReader i OutputStreamReader</p>
</details>
<!--      [Descarrega la solució ací](assets/Tema8/act805.zip)-->
<p>Però allò normal és que no s'utilitzen directament aquestes classes sino que es faja ús de <strong>FileReader i FileWriter</strong>.</p>
<h3 id="filereader-i-filewriter">FileReader i FileWriter</h3>
<p>Per llegir arxius de text o de caràcters es pot crear un flux del tipus <strong>FileReader</strong>, aquesta classe deriva d’InputStreamReader, hereta els mètodes read() per a llegir caràcters, el constructor té com entrada una cadena amb el nom de l’arxiu</p>
<p>Per exemple</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">String</span><span class="w"> </span><span class="n">strFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"cartes.dat"</span><span class="p">;</span>
<span class="n">FileReader</span><span class="w"> </span><span class="n">fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="n">strFile</span><span class="p">);</span>
<span class="n">fr</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
Els constructors de la classe <strong>FileReader</strong> són:</p>
<table>
<thead>
<tr>
<th>Constructor</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>FileReader(File file)</td>
<td>Crea un nou FileReader , amb el nom del fitxer des del qual cal llegir</td>
</tr>
<tr>
<td>FileReader(FileDescriptor fd)</td>
<td>Crea un nou FileReader , donat el FileDescriptor per llegir</td>
</tr>
<tr>
<td>FileReader(String fileName)</td>
<td>Crea un nou FileReader , amb el nom del fitxer des del qual cal llegir</td>
</tr>
</tbody>
</table>
<p>Els mètodes dels que disposa <strong>FileReader</strong> són:</p>
<ul>
<li><strong>Heretats de java.io.InputStreamReader:</strong> close, getEncoding, read, ready</li>
<li><strong>Heretats de java.io.Reader:</strong> mark, markSupported, read, reset, skip</li>
<li><strong>Heretats de java.lang.Object:</strong> clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait</li>
</ul>
<p>No es freqüent utilitzar directament fluxos <strong>OutputStreamWriter</strong>, encara que resulta interessant perquè la classe <strong>FileWriter</strong> és una extensió d’ella. Dissenyada per escriure en un arxiu de caràcters, els fluxos d’aquest tipus escriuen caràcters amb el mètode write() a l’arxiu al que s’associa el flux quan es crea l’objecte.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">String</span><span class="w"> </span><span class="n">strFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"cartes.dat"</span><span class="p">;</span>
<span class="n">FileReader</span><span class="w"> </span><span class="n">fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="n">strFile</span><span class="p">);</span>
<span class="n">nr</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">"Frase qualsevol a escriure"</span><span class="p">);</span>
<span class="n">nr</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
Els constructors de la classe <strong>FileWriter</strong> són:</p>
<table>
<thead>
<tr>
<th>Constructor</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>FileWriter(File file)</td>
<td>Construeix un objecte FileWriter donat un objecte File</td>
</tr>
<tr>
<td>FileWriter(File file, boolean append)</td>
<td>Construeix un objecte FileWriter donat un objecte File</td>
</tr>
<tr>
<td>FileWriter(FileDescriptor fd)</td>
<td>Construeix un objecte FileWriter associat a un descriptor de fitxer</td>
</tr>
<tr>
<td>FileWriter(String fileName)</td>
<td>Construeix un objecte FileWriter amb un nom de fitxer</td>
</tr>
<tr>
<td>FileWriter(String fileName, boolean append)</td>
<td>Construeix un objecte FileWriter amb un nom de fitxer amb un booleà que indica si s'han d'afegir o no les dades escrites</td>
</tr>
</tbody>
</table>
<p>En general no resulta eficient llegir directament d’un flux d’aquest tipus, s’utilitzarà un flux <strong>BufferedReader</strong> i <strong>BufferedWriter</strong></p>
<h3 id="bufferedreader-i-bufferedwriter">BufferedReader i BufferedWriter</h3>
<p>La lectura d’arxius de text es realitza amb un flux que emmagatzema els caràcters en un <strong>buffer</strong> intermedi, aquests no es lligen directament de l’arxiu si no del buffer. D’aquesta manera augmentem l’eficiència a les operacions d’entrada, la classe <strong>BufferedReader</strong> permet crear fluxos de caràcters amb buffer que no és més que una forma d’organitzar el flux bàsic de caràcters del que ve  el text perquè al crear un flux BufferReader, aquest s’inicialitza com un flux de caràcters InputStreamReader o qualsevol altre.</p>
<p>El constructor de la classe té un argument de tipus Reader, FileReader o InputStreamReader, el flux creat disposa d’un buffer de grandària suficient, el qual es pot especificar en el constructor amb un segon argument encara que no fa falta. Exemples de fluxos amb buffer.</p>
<p>Els mètodes de la classe <strong>BufferedReader</strong> són:</p>
<table>
<thead>
<tr>
<th>Mètode</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>void close()</td>
<td>Tanca el flux i allibera tots els recursos del sistema associats</td>
</tr>
<tr>
<td>void mark(int readAheadLimit)</td>
<td>Marca la posició actual al flux</td>
</tr>
<tr>
<td>boolean markSupported()</td>
<td>Indica si aquest flux admet l'operació mark(), que fa</td>
</tr>
<tr>
<td>read()</td>
<td>Llegeix un sol caràcter</td>
</tr>
<tr>
<td>int read(char[] cbuf, int off, int len)</td>
<td>Llegeix caràcters en una part d'una matriu</td>
</tr>
<tr>
<td>String readLine()</td>
<td>Llegeix una línia de text</td>
</tr>
<tr>
<td>boolean ready()</td>
<td>Indica si aquest flux està llest per ser llegit</td>
</tr>
<tr>
<td>void reset()</td>
<td>Restableix el flux a la marca més recent</td>
</tr>
<tr>
<td>long skip(long n)</td>
<td>Omet personatges</td>
</tr>
</tbody>
</table>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">File</span><span class="w"> </span><span class="n">someFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(...);</span>
<span class="kt">int</span><span class="w"> </span><span class="n">aCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">FileReader</span><span class="w"> </span><span class="n">fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="n">someFile</span><span class="p">);</span>
<span class="n">BufferedReader</span><span class="w"> </span><span class="n">br</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="n">fr</span><span class="p">);</span>

<span class="c1">// Count the number of 'a' characters.</span>
<span class="kt">int</span><span class="w"> </span><span class="n">ch</span><span class="p">;</span>
<span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">ch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">br</span><span class="p">.</span><span class="na">read</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ch</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">'a'</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">aCount</span><span class="o">++</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"There are "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">aCount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">" 'a' characters in "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">someFile</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p><strong>BufferedWriter</strong>, per un altre costat, escriu text en un flux de sortida de caràcters, guarda els caràcters en memòria intermèdia (buffer) per tal de proporcionar una escriptura eficient de caràcters, matrius i cadenes individuals.</p>
<p>Es pot especificar la mida de la memòria intermèdia o es pot acceptar la mida predeterminada. El valor predeterminat és prou gran per a la majoria de propòsits.</p>
<p>Es proporciona un mètode newLine(), que utilitza la pròpia noció de separador de línies de la plataforma tal com es defineix per la propietat del sistema line.separator . No totes les plataformes utilitzen el caràcter de nova línia ('\n') per acabar les línies. Per tant, es prefereix cridar aquest mètode per acabar cada línia de sortida que escriure directament un caràcter de nova línia.</p>
<p>Els mètodes de la classe són:</p>
<table>
<thead>
<tr>
<th>Mètode</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>void close()</td>
<td>Tanca el corrent, rentant-lo primer</td>
</tr>
<tr>
<td>void flush()</td>
<td>Redueix el corrent</td>
</tr>
<tr>
<td>void newLine()</td>
<td>Escriu un separador de línies</td>
</tr>
<tr>
<td>void   write(char[] cbuf, int off, int len)</td>
<td>Escriu una part d'una matriu de caràcters</td>
</tr>
<tr>
<td>void write(int c)</td>
<td>Escriu un sol caràcter</td>
</tr>
<tr>
<td>void write(String s, int off, int len)</td>
<td>Escriu una part d'una cadena</td>
</tr>
</tbody>
</table>
<p>Exemple</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.FileWriter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.BufferedWriter</span><span class="p">;</span>

<span class="n">String</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"This is the data in the output file"</span><span class="p">;</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Creates a FileWriter</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">strFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"output.txt"</span><span class="p">;</span>

<span class="w">  </span><span class="n">FileWriter</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileWriter</span><span class="p">(</span><span class="n">strFile</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Creates a BufferedWriter</span>
<span class="w">  </span><span class="n">BufferedWriter</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedWriter</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Writes the string to the file</span>
<span class="w">  </span><span class="n">output</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Closes the writer</span>
<span class="w">  </span><span class="n">output</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">e</span><span class="p">.</span><span class="na">getStackTrace</span><span class="p">();</span>
<span class="p">}</span>
<span class="w"> </span>
</code></pre></div></td></tr></table></div>
<h3 id="printwriter">PrintWriter</h3>
<p>Els fluxos més utilitzats en l’eixida de caràcters són de tipus PrintWriter, aquesta classe declara constructors per associar un flux PrintWriter amb qualsevol altre de tipus Writer o bé OutputStream.</p>
<table>
<thead>
<tr>
<th>Mètode</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>public PrintWriter(OutputStream destí)</td>
<td>Crea un flux associat amb un altre d’eixida a nivell de byte.</td>
</tr>
<tr>
<td>public PrintWriter(Writer destino)</td>
<td>Crea un flux associat amb un altre d’eixida de caràcters de tipus Writer.</td>
</tr>
</tbody>
</table>
<p>La importància d’aquesta classe radica en que defineix mètodes print() i println() per cadascun dels tipus de dades simples, per String i per Object; la diferència entre els mètodes print() i println() està en que el segon afegeix els caràcters de final de línia a continuació dels escrits per l’argument. </p>
<table>
<thead>
<tr>
<th>Mètode</th>
<th>Explicació</th>
</tr>
</thead>
<tbody>
<tr>
<td>public void print(Object obj)</td>
<td>Escriu la representació de l’objecte obj al flux</td>
</tr>
<tr>
<td>public void print(String cad)</td>
<td>Escriu la cadena al flux</td>
</tr>
<tr>
<td>public void print(char c)</td>
<td>Escriu el caràcter c al flux.</td>
</tr>
<tr>
<td>public void println(Object obj)</td>
<td>Escriu la representació de l’objecte obj al flux i final de línia</td>
</tr>
<tr>
<td>public void println(String cad)</td>
<td>Escriu la cadena al flux i el final de línia</td>
</tr>
<tr>
<td>public void println(char c)</td>
<td>Escriu el caràcter c al flux i final de línia.</td>
</tr>
</tbody>
</table>
<p>Exemple</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.PrintWriter</span><span class="p">;</span>

<span class="n">String</span><span class="w"> </span><span class="n">strFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"output.txt"</span><span class="p">;</span>
<span class="n">FileReader</span><span class="w"> </span><span class="n">fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="n">strFile</span><span class="p">);</span>
<span class="n">String</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"This is a text inside the file."</span><span class="p">;</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>

<span class="n">PrintWriter</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PrintWriter</span><span class="p">(</span><span class="n">strFile</span><span class="p">);</span>

<span class="n">output</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
<span class="n">output</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="n">e</span><span class="p">.</span><span class="na">getStackTrace</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<details class="question">
<summary>Activitat 806. FileWriter, FileReader, BufferedReader i PrintWriter</summary>
<p>Utilitzant les classes anteriors, obre un fitxer que continga text, llig tot el seu contingut i enregistra'l a un fitxer d'eixida amb la condició que has de canviar majúscules per minúscules i a l'inrevés des del fitxer d'origen.  </p>
<p>Has de tindre en compte que Processing IDE incorpora les seues pròpies classes BufferedReader i PrintWriter que podràs utilitzar en combinació amb FileWriter i FileReader per poder fer aquesta activitat.</p>
</details>
<!--      [Descarrega la solució ací](assets/Tema8/act806.zip)-->
<h2 id="arxius-dobjectes">Arxius d'objectes</h2>
<p>Fins ara hem tractat el tema d'entrada - eixida d'informació utilitzant els tipus primitius o bàsics que ens proporciona el llenguatge de programació: int, char, float, String... però que passa si el que volem desar o llegir des d'un dispositiu extern és un o diversos objectes? Com es guarden i com es recuperen aquestos objectes?</p>
<p>Java proporciona una mecanisme que s'anomena <strong>serialització</strong> que consisteix en convertir un objecte en una seqüència de bytes de tal forma que, ara sí, es podrà desar a un fitxer o un dispositiu extern. El procés de lectura d'un objecte serialitzat a un fitxer, per contra, s'anomena <strong>desserialització</strong>.</p>
<p>Per tal que un objecte continue existint, és a dir, que siga persistent, una vegada ja hem finalitzat l’execució d’un programa o aplicació l’hem de desar a un arxiu d’objectes. Per poder aconseguir açò, utilitzarem les classes <strong>ObjectInputStream i ObjectOutputStream</strong></p>
<h3 id="classe-dobjecte-persistent">Classe d'objecte persistent</h3>
<p><strong>Serialització:</strong> és el procés de convertir un objecte (incloses les referències a altres objectes) a una seqüència de bytes, així com també l'acció de reconstruir eixos bytes en un objecte viu en un futur. La serialització s'utilitza quan vols <strong>persistir</strong> un objecte, és a dir, que dure més que el que dura l'execució d'un programa o aplicació.</p>
<p>La declaració de la classe els objectes de la qual van a ser persistents, han de implementar la interfície <strong>«serializable»</strong> del paquet java.io, la qual és buida, no declara mètodes, simplement indica a la màquina virtual de Java que les instàncies d’aquestes classes podran gravar-se en un fitxer.</p>
<p>Exemples</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">class</span> <span class="nc">racional</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">serializable</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.Serializable</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SerialClass</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1L</span><span class="p">;</span>
<span class="w">   </span><span class="kd">private</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="n">currentTime</span><span class="p">;</span>

<span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="nf">SerialClass</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">currentTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Calendar</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">getTime</span><span class="p">();</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="nf">getCurrentTime</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">currentTime</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="objectoutputstream">ObjectOutputStream</h3>
<p>Els fluxos de la classe ObjectOutputStream s’utilitzen per gravar objectes persistents. El mètode writeObject() escriu qualsevol objecte d’una classe serializable en el flux de bytes associat. Pot llençar excepcions del tipus IOException que és necessari processar.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">writeObject</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<p>El constructor de la classe espera un argument de tipus OutputStream, que és la base dels fluxos d’eixida a nivell de bytes, per tant, per crear aquest tipus de fluxos primer es crea un d’eixida a nivell de bytes associat a un arxiu extern i a continuació, es passa com argument al constructor de ObjectOutputStream, per exemple:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">String</span><span class="w"> </span><span class="n">strFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sketchPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="na">separator</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"dadesRac.dat"</span><span class="p">;</span>
<span class="n">FileReader</span><span class="w"> </span><span class="n">fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="n">strFile</span><span class="p">);</span>
<span class="n">FileOutputStream</span><span class="w"> </span><span class="n">bn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="n">strFile</span><span class="p">);</span>
<span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">fobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="n">bn</span><span class="p">);</span>
<span class="n">bn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="n">fobj</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<p>A continuació es pot escriure qualsevol objecte al flux:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Persona</span><span class="w"> </span><span class="n">juan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Persona</span><span class="p">(</span><span class="s">"Juan"</span><span class="p">,</span><span class="s">"Martin"</span><span class="p">,</span><span class="w"> </span><span class="s">"123432123X"</span><span class="p">);</span>
<span class="n">fobj</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">juan</span><span class="p">);</span>
<span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="p">(</span><span class="s">"Cadena de favors"</span><span class="p">);</span>
<span class="n">fobj</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="n">fobj</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<h3 id="objectinputstream">ObjectInputStream</h3>
<p>El objectes guardats en arxius amb fluxos de la classe ObjectOutputStream es recuperen i lligen amb fluxos d’entrada del tipus ObjectInputStream, aquesta classe és una extensió d’InputStream, a més a més, implementa la interfície DataInput, per això disposa de diversos mètodes d’entrada (read) per cadascun dels tipus de dades com readInt() o altres. El mètode més important definit per la classe ObjectInputStream és readObject(), el qual llig un objecte del flux d’entrada, és a dir, de l’arxiu associat al flux de baix nivell; l’objecte llegit es va escriure en el seu moment amb el mètode writeObject()</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">readObject</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<p>El constructor de fluxos ObjectInputStream té com entrada un altre flux de baix nivell de qualsevol tipus derivat d’InputStream, per exemple: FileInputStream associat amb l’arxiu d’objectes. A continuació es crea un flux d’entrada per llegir els objectes de l’arxiu «arxiuObjects.dat»</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ObjectInputStream</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectInputStream</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="s">"arxiuObjects.dat"</span><span class="p">));</span>
<span class="n">obj</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<p>El constructor de la classe <strong>ObjectOutputStream</strong> llença una excepció si, per exemple, l’arxiu no existeix, aquella és del tipus «ClassNotFoundException» o «IOException», és necessari poder capturar aquestes excepcions</p>
<details class="danger" open="open">
<summary>Compte on poses el codi</summary>
<p>Ja que l'entorn de desenvolupament que estem utilitzant, Processing IDE, no és un IDE a l'ús com l'Eclipse IDE, Visual Studio Code o NetBeans, la serialització d'objectes pot donar errors. És <strong>molt important</strong> que el codi relatiu als ObjectInputStream i ObjectInputStream estiga escrit en fitxers que no tinguen l'extensió <strong>.pde</strong> i tinguen una extensió <strong>.java</strong>. En altres paraules, aquelles classes que siguen susceptibles de ser serialitzades: </p>
<p><strong>(1)</strong> Tindran tot el codi amb els objectes ObjectOutputStream i ObjectInputStream per poder llegir i escriure objectes en fitxers.
  <strong>(2)</strong> Es desaran amb l'extensió <em>java</em> i <strong>MAI</strong> <em>pde</em>.</p>
</details>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1">Main</label><label for="__tabbed_1_2">Dog</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Creates an object of Dog class</span>
<span class="w">  </span><span class="n">Dog</span><span class="w"> </span><span class="n">dog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Dog</span><span class="p">(</span><span class="s">"Tyson"</span><span class="p">,</span><span class="w"> </span><span class="s">"Labrador"</span><span class="p">);</span>
<span class="w">  </span><span class="n">dog</span><span class="p">.</span><span class="na">save</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.*</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Dog</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span>

<span class="w">   </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">   </span><span class="n">String</span><span class="w"> </span><span class="n">breed</span><span class="p">;</span>

<span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="nf">Dog</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">breed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">breed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">breed</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">save</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">FileOutputStream</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="s">"file.txt"</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Creates an ObjectOutputStream</span>
<span class="w">            </span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Writes objects to the output stream</span>
<span class="w">            </span><span class="n">output</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">dog</span><span class="p">);</span>

<span class="w">            </span><span class="n">FileInputStream</span><span class="w"> </span><span class="n">fileStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="s">"file.txt"</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Creates an ObjectInputStream</span>
<span class="w">            </span><span class="n">ObjectInputStream</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectInputStream</span><span class="p">(</span><span class="n">fileStream</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Reads the objects</span>
<span class="w">            </span><span class="n">Dog</span><span class="w"> </span><span class="n">newDog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Dog</span><span class="p">)</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="na">readObject</span><span class="p">();</span>

<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Dog Name: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">newDog</span><span class="p">.</span><span class="na">name</span><span class="p">);</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Dog Breed: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">newDog</span><span class="p">.</span><span class="na">breed</span><span class="p">);</span>

<span class="w">            </span><span class="n">output</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="w">            </span><span class="n">input</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span><span class="w">    </span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</input></input></div>
<details class="question">
<summary>Activitat 807. Classe alumne</summary>
<p>Dissenya una aplicació amb Processing IDE on es podrà per un costat introduir informació d'alumnes que es guardaran en un fitxer que s'anomene: 'alumnes.dat'. </p>
<p>Al principi l'aplicació llegirà de l'arxiu 'alumnes.dat' tots els alumnes inscrits al curs i els mostrar per pantalla, ordenats alfabèticament pel cognom. </p>
<p>Una vegada haja mostrat tots els alumnes, l'aplicació esperarà que s'introduisca algun alumne nou per consola, una vegada introduits totes les dades de l'alumne, aquesta es guardarà en un objecte primer i després al fitxer 'alumnes.dat' a continuació dels que ja havien estat enregistrats. </p>
<p>Finalment tornarà a mostrar els alumnes ordenats alfabèticament i torna a començar.</p>
<p><a href="../assets/Tema8/ProvaObjectes.zip">Descarrega un exemple ací</a></p>
</details>
<h2 id="fitxers-xml">Fitxers XML</h2>
<details class="question">
<summary>Activitat 808. Processa un document XML en Java</summary>
</details>
<details class="question">
<summary>Activitat 809. Aplicació traductora amb XML</summary>
</details>
<h2 id="excepcions">Excepcions</h2>
<p>Un problema important en el desenvolupament del programari és la gestió de les errades o errors. No importa quan bé estiga planificat aquest desenvolupament i quan eficient siga l’equip desenvolupador. És una màxima en informàtica el fet que sempre apareixeran problemes. Aquests problemes inesperats són problemes o errors que apareixen en temps d’execució, per exemple: esgotament de memòria o recursos, errors en els intervals dels bucles, divisions per zero, arxius no existents, etc..</p>
<p>Les excepcions són el mecanisme previst per Java per tractar aquests problemes sobrevinguts. Amb les excepcions, Java dona la possibilitat al programador salvar aquest tipus de situacions de manera controlada sense que el programa o aplicació es tanque, bloquege o deixe de respondre.</p>
<h3 id="condicions-derrors-en-programes">Condicions d'errors en programes</h3>
<p>Programar, escriure codi, mètodes, classes, etc.. que siga eficient, eficaç i lliure d’errades és altament complicat. El control d’errades és una part tant important en el disseny d’aplicacions que a totes les diferents metodologia de cicle de vida software, hi ha una fase que es dedica única i exclusivament a detectar aquestes errades i solucionar-les i així i tot és impossible produir programari totalment lliure d’errades.</p>
<h3 id="tractament-dels-codis-derror">Tractament dels codis d'error</h3>
<p>Java inclou un mecanisme de gestió d’excepcions per poder intentat cobrir possibles errades en els programes en temps d’execució. Aquest mecanisme consisteix en capturar (catch) els errors quan es produeixen en temps d’execució.</p>
<p>Quan es produeix un fallo en temps d’execució es podrien fer tres coses: parar l’execució de sobte, continuar executant esperant que no passe res o establir una senyal d’error que el mateix codi amb altres sentències s’encarregue de gestionar.</p>
<p>Aquestes senyals que envia (throw) el programa quan es produeix alguna errada en Java s’anomenen excepcions i el bloc del codi on es posen les sentències per tal d’intentar solucionar-lo en temps d’execució és el bloc catch.</p>
<h3 id="excepcions-en-java">Excepcions en Java</h3>
<p>Una excepció és un fallo que es produeix en temps d’execució. Si hem escrit bé el codi per tal de gestionar aquest fallo, el flux d’execució passa al codi destinat a gestionar les excepcions, en cas contrari el programa acaba la seua execució.</p>
<p>Aquestes excepcions es poden produir per exemple si intenten accedir a un element d’un array fora dels seus límits, si intentem obrir un fitxer que no existeix o està bloquejat, si dividim per zero, etc..</p>
<p>El model de gestió d’excepcions a Java afegeix cinc noves paraules reservades: try, throw, throws, catch i finally.</p>
<ul>
<li><strong>try:</strong> bloc on es detectaran les excepcions</li>
<li><strong>catch:</strong> captura les excepcions que es produeixen al bloc try </li>
<li><strong>throw:</strong> expressió per llençar excepcions</li>
<li><strong>throws:</strong> indica les excepcions que pot llençar un mètode.</li>
<li><strong>finally:</strong> bloc opcional situat després del try catch</li>
</ul>
<p>Les passes del model de control d’excepcions en Java són:</p>
<ol>
<li>El bloc try conté les instruccions o part del codi susceptible de provocar algun error.</li>
<li>Si en temps d’execució es produeix algun error dins de les sentències que es troben dins del bloc try, es llença una excepció.</li>
<li>S’executa el codi que es troba dins del bloc catch associat a la excepció que s’ha llençat al punt anterior.</li>
<li>S’executa el bloc finally (opcional)</li>
</ol>
<p>Exemple. Suposem una classe persona que incorporarem a la nostra aplicació. Aquesta classe té un constructor al qual se li passa el DNI, imaginem ara que de la nostra aplicació instanciem un objecte de la classe persona a la qual l direm Joan però quan cridem al constructor de la classe no li passem un DNI, aquest «mal ús» de la classe Persona, llençaria una excepció que hauria de capturar la nostra aplicació al bloc catch i és ací, en aquest bloc d’instruccions, en el que s’hauria de corregir la situació o avisar a l’usuari de l’aplicació del que ha passat.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">escolta</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="c1">// Codi del metode escolta</span>
<span class="w">   </span><span class="c1">// ...</span>
<span class="w">   </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">escolta</span><span class="p">();</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">catch</span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Codi a executar quan es produeix una excepció.</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Al codi anterior hem crear un mètode escolta que l’únic que fa és llençar una excepció. Quan al mètode main cridem a la funció escolta, si volem fer ús del sistema d’excepcions de Java, l’haurem de posar dins del bloc try. Just desprès d’acabar el conjunt d’instruccions del bloc try posem un catch indicant-li quina és la classe d’excepció que hauriem de capturar, al nostre cas Exception, i dins del bloc catch posariem el codi que s’hauria d’executar en cas de produir-se eixe error. Normalment es solen posar missatges d’error que alerten l’usuari de l’aplicació.</p>
<p>A continuació explicarem amb més detall què és el que fan cadascun dels blocs del mecanisme d’excepcions que ha dissenyat Java.</p>
<h3 id="bloc-try">Bloc try</h3>
<p>Dins del bloc try s’han de posar aquelles sentències que poden llençar alguna excepció entre claudàtors, després del claudàtor de tancament s’ha de posar el bloc catch o controlador d’excepcions almenys un bloc catch. Si l’excepció que es produeix coincideix amb algun dels paràmetres dels blocs catch que hi han, s’executen les sentències que es troben a dintre.</p>
<p>Els blocs try, de la mateixa forma que amb totes les sentències de programació estructurada, es poden niar.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">escolta</span><span class="p">();</span>

<span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="n">tornaAEscoltar</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="c1">// Codi excepció interna</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Codi excepció externa</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>A l’exemple anterior és pot observar un codi amb dos blocs try niats on el primer bloc try té dos blocs catch per controlar varies excepcions</p>
<h3 id="bloc-throw">Bloc throw</h3>
<p>La sentència throw llença (raise) una excepció. Les excepcions en Java són objectes, per tant, una excepció és una instància d’una classe que deriva de la classe Exception
A l’exemple anterior com es pot observar es capturen dos tipus d’excepcions diferents, una generica Exception i una altra FileNotFoundException. Aquesta última es produeix normalment quan volem obrir un fitxer, amb la classe File per exemple, i aquest no existeix.    </p>
<h3 id="bloc-catch">Bloc catch</h3>
<p>El bloc catch o de captura d’excepcions. Quan una excepció es llença des d’un bloc try, si el tipus d’excepció que s’ha llençat coincideix amb el tipus d’excepció que s’ha passat per paràmetre al catch, s’executarien les sentències que hi han dins del bloc catch. Normalment es sol posar el codi necessari per poder eixir de la situació en la que ens trobem quan s’alça una excepció.</p>
<h3 id="clausula-finally">Clàusula finally</h3>
<p>El bloc finally en un try..catch, és el bloc d’instruccions que s’executarà sempre, hi haja excepcions o no, al final de tot el nostre codi. 
Normalment es solen posar sentències per tal d’alliberar tot allò que podem haver creat dins del bloc try, és a dir, tancar fluxos, fitxers, connexions a bases de dades etc..amb la finalitat d’alliberar memòria.</p>
<h3 id="classes-dexcepcions-en-java">Classes d'excepcions en Java</h3>
<p><img alt="Excepcions Java" src="../assets/Tema8/Excepcions.png"/></p>
<h3 id="creacio-dexcepcions">Creació d'excepcions</h3>
<p>Java permet la creació d’excepcions noves que deriven de la classe base Exception</p>
<details class="question">
<summary>Activitat 810. Crear i utilitzar una excepció personalitzada</summary>
</details>
<p>Crea una classe d'excepció personalitzada anomenada NumeroNegatiuException que hereti de la classe Exception. Aquesta excepció s'haurà de llançar quan un valor numèric negatiu sigui introduït en el programa.</p>
<p>Crea un mètode anomenat verificarNumero(int numero) que comprovi si el número és negatiu. Si el número és negatiu, ha de llençar la teva excepció personalitzada (NumeroNegatiuException).</p>
<p>En el mètode main, crida el mètode verificarNumero i captura la excepció per mostrar un missatge d'error si s'introdueix un número negatiu.</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "toc.integrate"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../assets/javascripts/bundle.b4d07000.min.js"></script>
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</body>
</html>